
<!DOCTYPE html>
<html lang="en">
<head>
  <link href='//fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700,400italic' rel='stylesheet' type='text/css'>

    <link rel="stylesheet" type="text/css" href="http://adityamangal.com/theme/stylesheet/style.min.css">

  <link rel="stylesheet" type="text/css" href="http://adityamangal.com/theme/pygments/github.min.css">
  <link rel="stylesheet" type="text/css" href="http://adityamangal.com/theme/font-awesome/css/font-awesome.min.css">




    <link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon">
    <link rel="icon" href="/images/favicon.png" type="image/x-icon">

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="robots" content="index, follow" />

    <!-- Chrome, Firefox OS and Opera -->
    <meta name="theme-color" content="#333333">
    <!-- Windows Phone -->
    <meta name="msapplication-navbutton-color" content="#333333">
    <!-- iOS Safari -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

<meta name="author" content="Aditya Mangal" />
<meta name="description" content="Goal of this Visualization task is to create an alternative visualization to the Tableau's visualization for Winter Olympics data for different countries. In this blog post, I'm trying to generate a World Choropleth Map showing the total counts of medals for each country. Cleaning up workspace and loading required libraries …" />
<meta name="keywords" content="R, Visualizations, MakeOverMonday, DataAnalysis, DataScience, Olympics">
<meta property="og:site_name" content="Aditya Mangal's Blog"/>
<meta property="og:title" content="The Winter Olympics: MakeOverMonday 2018 Week7"/>
<meta property="og:description" content="Goal of this Visualization task is to create an alternative visualization to the Tableau's visualization for Winter Olympics data for different countries. In this blog post, I'm trying to generate a World Choropleth Map showing the total counts of medals for each country. Cleaning up workspace and loading required libraries …"/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="http://adityamangal.com/the-winter-olympics-makeovermonday-2018-week7.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2018-02-15 17:51:00-08:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="http://adityamangal.com/author/aditya-mangal.html">
<meta property="article:section" content="MakeOverMonday"/>
<meta property="article:tag" content="R"/>
<meta property="article:tag" content="Visualizations"/>
<meta property="article:tag" content="MakeOverMonday"/>
<meta property="article:tag" content="DataAnalysis"/>
<meta property="article:tag" content="DataScience"/>
<meta property="article:tag" content="Olympics"/>
<meta property="og:image" content="/images/profile.png">

  <title>Aditya Mangal's Blog &ndash; The Winter Olympics: MakeOverMonday 2018 Week7</title>

</head>
<body>
  <aside>
    <div>
      <a href="http://adityamangal.com">
        <img src="/images/profile.png" alt="Aditya Mangal" title="Aditya Mangal">
      </a>
      <h1><a href="http://adityamangal.com">Aditya Mangal</a></h1>

<p>Software Engineer, Data Science Enthusiast</p>
      <nav>
        <ul class="list">
          <li><a href="http://adityamangal.com/pages/about-me.html#about-me">About Me</a></li>
          <li><a href="http://adityamangal.com/pages/contact.html#contact">Contact</a></li>

          <li><a href="http://adityamangal.com" target="_blank">Portfolio</a></li>
        </ul>
      </nav>

      <ul class="social">
        <li><a class="sc-github" href="https://github.com/adityamangal410" target="_blank"><i class="fa fa-github"></i></a></li>
        <li><a class="sc-linkedin" href="https://www.linkedin.com/in/adityamangal410/" target="_blank"><i class="fa fa-linkedin"></i></a></li>
      </ul>
    </div>


  </aside>
  <main>

    <nav>
      <a href="http://adityamangal.com">    Home
</a>

      <a href="/archives.html">Archives</a>
      <a href="/categories.html">Categories</a>
      <a href="/tags.html">Tags</a>


    </nav>

<article class="single">
  <header>
    <h1 id="the-winter-olympics-makeovermonday-2018-week7">The Winter Olympics: MakeOverMonday 2018 Week7</h1>
    <p>
          Posted on February 15, 2018 in <a href="http://adityamangal.com/category/makeovermonday.html">MakeOverMonday</a>


    </p>
  </header>


  <div>
    <p>Goal of this Visualization task is to create an alternative visualization to the <a href="https://public.tableau.com/views/TheWinterOlympics/TheWinterOlympics?:embed=y&:showVizHome=no" target="_blank">Tableau's visualization for Winter Olympics data for different countries.</a></p>
<p>In this blog post, I'm trying to generate a World Choropleth Map showing the total counts of medals for each country.</p>
<h2>Cleaning up workspace and loading required libraries</h2>
<div class="highlight"><pre><span></span><span class="kp">rm</span><span class="p">(</span><span class="kt">list</span> <span class="o">=</span> <span class="kp">ls</span><span class="p">())</span>
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>tidyverse<span class="p">)</span> <span class="c1">#Data Wrangling</span>
</pre></div>


<div class="highlight"><pre><span></span>## -- Attaching packages ---------------------------------- tidyverse 1.2.1 --
</pre></div>


<div class="highlight"><pre><span></span>## &lt;U+221A&gt; ggplot2 2.2.1     &lt;U+221A&gt; purrr   0.2.4
## &lt;U+221A&gt; tibble  1.4.2     &lt;U+221A&gt; dplyr   0.7.4
## &lt;U+221A&gt; tidyr   0.8.0     &lt;U+221A&gt; stringr 1.2.0
## &lt;U+221A&gt; readr   1.1.1     &lt;U+221A&gt; forcats 0.2.0
</pre></div>


<div class="highlight"><pre><span></span>## -- Conflicts ------------------------------------- tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
</pre></div>


<div class="highlight"><pre><span></span><span class="kn">library</span><span class="p">(</span>readxl<span class="p">)</span> <span class="c1">#Data Ingestion</span>
<span class="kn">library</span><span class="p">(</span>plotly<span class="p">)</span> <span class="c1">#Data Visualization</span>
</pre></div>


<div class="highlight"><pre><span></span>## 
## Attaching package: &#39;plotly&#39;
</pre></div>


<div class="highlight"><pre><span></span>## The following object is masked from &#39;package:ggplot2&#39;:
## 
##     last_plot
</pre></div>


<div class="highlight"><pre><span></span>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter
</pre></div>


<div class="highlight"><pre><span></span>## The following object is masked from &#39;package:graphics&#39;:
## 
##     layout
</pre></div>


<h2>Obtaining Data</h2>
<p>Reading and viewing the dataset</p>
<div class="highlight"><pre><span></span>olympics <span class="o">=</span> read_excel<span class="p">(</span><span class="s">&quot;/tmp/Winer Olympic Medals.xlsx&quot;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>olympics
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 2,865 x 9
##     Year Sport  Event  Country Gender `Medal Rank` Medal `Name of Athlete~
##    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;            
##  1  1924 Bobsl~ Men&#39;s~ Switze~ Men            1.00 gold  Switzerland-1    
##  2  1924 Bobsl~ Men&#39;s~ Britain Men            2.00 silv~ Britain-1        
##  3  1924 Bobsl~ Men&#39;s~ Belgium Men            3.00 bron~ Belgium-1        
##  4  1924 Cross~ Men&#39;s~ Norway  Men            1.00 gold  Thorleif Haug    
##  5  1924 Cross~ Men&#39;s~ Norway  Men            2.00 silv~ &quot;Johan Gr\u00c3\~
##  6  1924 Cross~ Men&#39;s~ Finland Men            3.00 bron~ Tapani Niku      
##  7  1924 Cross~ Men&#39;s~ Norway  Men            1.00 gold  Thorleif Haug    
##  8  1924 Cross~ Men&#39;s~ Norway  Men            2.00 silv~ &quot;Thoralf Str\u00~
##  9  1924 Cross~ Men&#39;s~ Norway  Men            3.00 bron~ &quot;Johan Gr\u00c3\~
## 10  1924 Curli~ Men&#39;s~ Britain Men            1.00 gold  Britain          
## # ... with 2,855 more rows, and 1 more variable: `Age of Athlete` &lt;dbl&gt;
</pre></div>


<p>Summarizing and getting stats to better understand the dataset</p>
<div class="highlight"><pre><span></span>olympics <span class="o">%&gt;%</span> 
  glimpse<span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>## Observations: 2,865
## Variables: 9
## $ Year                      &lt;dbl&gt; 1924, 1924, 1924, 1924, 1924, 1924, ...
## $ Sport                     &lt;chr&gt; &quot;Bobsled&quot;, &quot;Bobsled&quot;, &quot;Bobsled&quot;, &quot;Cr...
## $ Event                     &lt;chr&gt; &quot;Men&#39;s Four/Five&quot;, &quot;Men&#39;s Four/Five&quot;...
## $ Country                   &lt;chr&gt; &quot;Switzerland&quot;, &quot;Britain&quot;, &quot;Belgium&quot;,...
## $ Gender                    &lt;chr&gt; &quot;Men&quot;, &quot;Men&quot;, &quot;Men&quot;, &quot;Men&quot;, &quot;Men&quot;, &quot;...
## $ `Medal Rank`              &lt;dbl&gt; 1, 2, 3, 1, 2, 3, 1, 2, 3, 1, 2, 3, ...
## $ Medal                     &lt;chr&gt; &quot;gold&quot;, &quot;silver&quot;, &quot;bronze&quot;, &quot;gold&quot;, ...
## $ `Name of Athlete or Team` &lt;chr&gt; &quot;Switzerland-1&quot;, &quot;Britain-1&quot;, &quot;Belgi...
## $ `Age of Athlete`          &lt;dbl&gt; NA, NA, NA, 29, 24, 28, 29, 27, 24, ...
</pre></div>


<div class="highlight"><pre><span></span>olympics <span class="o">%&gt;%</span> 
  <span class="kp">summary</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>##       Year         Sport              Event             Country         
##  Min.   :1924   Length:2865        Length:2865        Length:2865       
##  1st Qu.:1972   Class :character   Class :character   Class :character  
##  Median :1992   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :1986                                                           
##  3rd Qu.:2006                                                           
##  Max.   :2014                                                           
##                                                                         
##     Gender            Medal Rank       Medal          
##  Length:2865        Min.   :1.000   Length:2865       
##  Class :character   1st Qu.:1.000   Class :character  
##  Mode  :character   Median :2.000   Mode  :character  
##                     Mean   :1.996                     
##                     3rd Qu.:3.000                     
##                     Max.   :3.000                     
##                                                       
##  Name of Athlete or Team Age of Athlete 
##  Length:2865             Min.   :14.00  
##  Class :character        1st Qu.:22.00  
##  Mode  :character        Median :25.00  
##                          Mean   :25.15  
##                          3rd Qu.:28.00  
##                          Max.   :42.00  
##                          NA&#39;s   :692
</pre></div>


<h2>Scrubbing data</h2>
<p>As per the dataset requirement, East and West Germany are to be grouped with Germany and Soviet Union and the 1992 Unified Team needs to be combined with Russia</p>
<div class="highlight"><pre><span></span>olympics <span class="o">=</span> olympics <span class="o">%&gt;%</span> 
  mutate<span class="p">(</span>Country <span class="o">=</span> recode<span class="p">(</span>Country<span class="p">,</span> <span class="s">&quot;Soviet Union&quot;</span> <span class="o">=</span> <span class="s">&quot;Russia&quot;</span><span class="p">,</span> <span class="s">&quot;Unified Team&quot;</span> <span class="o">=</span> <span class="s">&quot;Russia&quot;</span><span class="p">,</span>
                          <span class="s">&quot;East Germany&quot;</span> <span class="o">=</span> <span class="s">&quot;Germany&quot;</span><span class="p">,</span> <span class="s">&quot;West Germany&quot;</span> <span class="o">=</span> <span class="s">&quot;Germany&quot;</span><span class="p">))</span>
</pre></div>


<p>Reading in the ISO-3166 country codes dataset in order to generate the choropleth</p>
<div class="highlight"><pre><span></span>countryCodes <span class="o">=</span> read_csv<span class="p">(</span><span class="s">&quot;https://raw.githubusercontent.com/lukes/ISO-3166-Countries-with-Regional-Codes/master/all/all.csv&quot;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Parsed with column specification:
## cols(
##   name = col_character(),
##   `alpha-2` = col_character(),
##   `alpha-3` = col_character(),
##   `country-code` = col_character(),
##   `iso_3166-2` = col_character(),
##   region = col_character(),
##   `sub-region` = col_character(),
##   `region-code` = col_character(),
##   `sub-region-code` = col_character()
## )
</pre></div>


<div class="highlight"><pre><span></span>countryCodes
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 249 x 9
##    name            `alpha-2` `alpha-3` `country-code` `iso_3166-2` region 
##    &lt;chr&gt;           &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt;  
##  1 Afghanistan     AF        AFG       004            ISO 3166-2:~ Asia   
##  2 &quot;\u00c5land Is~ AX        ALA       248            ISO 3166-2:~ Europe 
##  3 Albania         AL        ALB       008            ISO 3166-2:~ Europe 
##  4 Algeria         DZ        DZA       012            ISO 3166-2:~ Africa 
##  5 American Samoa  AS        ASM       016            ISO 3166-2:~ Oceania
##  6 Andorra         AD        AND       020            ISO 3166-2:~ Europe 
##  7 Angola          AO        AGO       024            ISO 3166-2:~ Africa 
##  8 Anguilla        AI        AIA       660            ISO 3166-2:~ Americ~
##  9 Antarctica      AQ        ATA       010            ISO 3166-2:~ &lt;NA&gt;   
## 10 Antigua and Ba~ AG        ATG       028            ISO 3166-2:~ Americ~
## # ... with 239 more rows, and 3 more variables: `sub-region` &lt;chr&gt;,
## #   `region-code` &lt;chr&gt;, `sub-region-code` &lt;chr&gt;
</pre></div>


<p>Joining the 2 datasets and verifying if any country name mismatch happening in the 2.</p>
<div class="highlight"><pre><span></span>olympics <span class="o">%&gt;%</span> 
  left_join<span class="p">(</span>countryCodes<span class="p">,</span> by<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;Country&quot;</span> <span class="o">=</span> <span class="s">&quot;name&quot;</span><span class="p">))</span> <span class="o">%&gt;%</span> 
  filter<span class="p">(</span><span class="kp">is.na</span><span class="p">(</span><span class="sb">`alpha-3`</span><span class="p">))</span> <span class="o">%&gt;%</span> 
  select<span class="p">(</span>Country<span class="p">)</span> <span class="o">%&gt;%</span> 
  <span class="kp">unique</span><span class="p">()</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 7 x 1
##   Country       
##   &lt;chr&gt;         
## 1 Britain       
## 2 United States 
## 3 Czechoslovakia
## 4 Russia        
## 5 North Korea   
## 6 Yugoslavia    
## 7 South Korea
</pre></div>


<p>Looks like above 7 countries do not have a corresponding entry in the countryCodes dataset.
Lets try to find out the corresponding names for each of the 7 in the countryCodes dataset.</p>
<div class="highlight"><pre><span></span>countryCodes <span class="o">%&gt;%</span> 
  filter<span class="p">(</span>str_detect<span class="p">(</span>str_to_lower<span class="p">(</span>name<span class="p">),</span> <span class="s">&quot;britain&quot;</span><span class="p">))</span> <span class="c1">#United Kingdom of Great Britain and Northern Ireland</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 1 x 9
##   name              `alpha-2` `alpha-3` `country-code` `iso_3166-2` region
##   &lt;chr&gt;             &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt; 
## 1 United Kingdom o~ GB        GBR       826            ISO 3166-2:~ Europe
## # ... with 3 more variables: `sub-region` &lt;chr&gt;, `region-code` &lt;chr&gt;,
## #   `sub-region-code` &lt;chr&gt;
</pre></div>


<div class="highlight"><pre><span></span>countryCodes <span class="o">%&gt;%</span> 
  filter<span class="p">(</span>str_detect<span class="p">(</span>str_to_lower<span class="p">(</span>name<span class="p">),</span> <span class="s">&quot;states&quot;</span><span class="p">))</span> <span class="c1">#United States of America</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 3 x 9
##   name             `alpha-2` `alpha-3` `country-code` `iso_3166-2`  region
##   &lt;chr&gt;            &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;         &lt;chr&gt; 
## 1 Micronesia (Fed~ FM        FSM       583            ISO 3166-2:FM Ocean~
## 2 United States o~ US        USA       840            ISO 3166-2:US Ameri~
## 3 United States M~ UM        UMI       581            ISO 3166-2:UM &lt;NA&gt;  
## # ... with 3 more variables: `sub-region` &lt;chr&gt;, `region-code` &lt;chr&gt;,
## #   `sub-region-code` &lt;chr&gt;
</pre></div>


<div class="highlight"><pre><span></span>countryCodes <span class="o">%&gt;%</span> 
  filter<span class="p">(</span>str_detect<span class="p">(</span>str_to_lower<span class="p">(</span>name<span class="p">),</span> <span class="s">&quot;czech&quot;</span><span class="p">))</span> <span class="c1">#Czech Republic</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 1 x 9
##   name           `alpha-2` `alpha-3` `country-code` `iso_3166-2`  region
##   &lt;chr&gt;          &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;         &lt;chr&gt; 
## 1 Czech Republic CZ        CZE       203            ISO 3166-2:CZ Europe
## # ... with 3 more variables: `sub-region` &lt;chr&gt;, `region-code` &lt;chr&gt;,
## #   `sub-region-code` &lt;chr&gt;
</pre></div>


<div class="highlight"><pre><span></span>countryCodes <span class="o">%&gt;%</span> 
  filter<span class="p">(</span>str_detect<span class="p">(</span>str_to_lower<span class="p">(</span>name<span class="p">),</span> <span class="s">&quot;russia&quot;</span><span class="p">))</span> <span class="c1">#Russian Federation</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 1 x 9
##   name              `alpha-2` `alpha-3` `country-code` `iso_3166-2` region
##   &lt;chr&gt;             &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt; 
## 1 Russian Federati~ RU        RUS       643            ISO 3166-2:~ Europe
## # ... with 3 more variables: `sub-region` &lt;chr&gt;, `region-code` &lt;chr&gt;,
## #   `sub-region-code` &lt;chr&gt;
</pre></div>


<div class="highlight"><pre><span></span>countryCodes <span class="o">%&gt;%</span> 
  filter<span class="p">(</span>str_detect<span class="p">(</span>str_to_lower<span class="p">(</span>name<span class="p">),</span> <span class="s">&quot;korea&quot;</span><span class="p">))</span> <span class="c1">#Korea (Democratic People&#39;s Republic of) = North Korea, Korea (Republic of) = South Korea</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 2 x 9
##   name              `alpha-2` `alpha-3` `country-code` `iso_3166-2` region
##   &lt;chr&gt;             &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt; 
## 1 Korea (Democrati~ KP        PRK       408            ISO 3166-2:~ Asia  
## 2 Korea (Republic ~ KR        KOR       410            ISO 3166-2:~ Asia  
## # ... with 3 more variables: `sub-region` &lt;chr&gt;, `region-code` &lt;chr&gt;,
## #   `sub-region-code` &lt;chr&gt;
</pre></div>


<div class="highlight"><pre><span></span>countryCodes <span class="o">%&gt;%</span> 
  filter<span class="p">(</span>str_detect<span class="p">(</span>str_to_lower<span class="p">(</span>name<span class="p">),</span> <span class="s">&quot;yugo&quot;</span><span class="p">))</span> <span class="c1">#Macedonia (the former Yugoslav Republic of)</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 1 x 9
##   name              `alpha-2` `alpha-3` `country-code` `iso_3166-2` region
##   &lt;chr&gt;             &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;          &lt;chr&gt;        &lt;chr&gt; 
## 1 Macedonia (the f~ MK        MKD       807            ISO 3166-2:~ Europe
## # ... with 3 more variables: `sub-region` &lt;chr&gt;, `region-code` &lt;chr&gt;,
## #   `sub-region-code` &lt;chr&gt;
</pre></div>


<p>Renaming mismatched countries in olympic dataset based on countryCodes dataset.</p>
<div class="highlight"><pre><span></span>olympics <span class="o">=</span> olympics <span class="o">%&gt;%</span> 
  mutate<span class="p">(</span>Country <span class="o">=</span> recode<span class="p">(</span>Country<span class="p">,</span>
                          <span class="s">&quot;Britain&quot;</span> <span class="o">=</span> <span class="s">&quot;United Kingdom of Great Britain and Northern Ireland&quot;</span><span class="p">,</span>
                          <span class="s">&quot;United States&quot;</span> <span class="o">=</span> <span class="s">&quot;United States of America&quot;</span><span class="p">,</span>
                          <span class="s">&quot;Czechoslovakia&quot;</span> <span class="o">=</span> <span class="s">&quot;Czech Republic&quot;</span><span class="p">,</span>
                          <span class="s">&quot;Russia&quot;</span> <span class="o">=</span> <span class="s">&quot;Russian Federation&quot;</span><span class="p">,</span>
                          <span class="s">&quot;North Korea&quot;</span> <span class="o">=</span> <span class="s">&quot;Korea (Democratic People&#39;s Republic of)&quot;</span><span class="p">,</span>
                          <span class="s">&quot;South Korea&quot;</span> <span class="o">=</span> <span class="s">&quot;Korea (Republic of)&quot;</span><span class="p">,</span>
                          <span class="s">&quot;Yugoslavia&quot;</span> <span class="o">=</span> <span class="s">&quot;Macedonia (the former Yugoslav Republic of)&quot;</span><span class="p">))</span>
</pre></div>


<p>Joining and viewing the 2 datasets</p>
<div class="highlight"><pre><span></span>olympics <span class="o">=</span> olympics <span class="o">%&gt;%</span> 
  left_join<span class="p">(</span>countryCodes<span class="p">,</span> by<span class="o">=</span><span class="kt">c</span><span class="p">(</span><span class="s">&quot;Country&quot;</span> <span class="o">=</span> <span class="s">&quot;name&quot;</span><span class="p">))</span>
olympics
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 2,865 x 17
##     Year Sport  Event  Country  Gender `Medal Rank` Medal `Name of Athlet~
##    &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt;           
##  1  1924 Bobsl~ Men&#39;s~ Switzer~ Men            1.00 gold  Switzerland-1   
##  2  1924 Bobsl~ Men&#39;s~ United ~ Men            2.00 silv~ Britain-1       
##  3  1924 Bobsl~ Men&#39;s~ Belgium  Men            3.00 bron~ Belgium-1       
##  4  1924 Cross~ Men&#39;s~ Norway   Men            1.00 gold  Thorleif Haug   
##  5  1924 Cross~ Men&#39;s~ Norway   Men            2.00 silv~ &quot;Johan Gr\u00c3~
##  6  1924 Cross~ Men&#39;s~ Finland  Men            3.00 bron~ Tapani Niku     
##  7  1924 Cross~ Men&#39;s~ Norway   Men            1.00 gold  Thorleif Haug   
##  8  1924 Cross~ Men&#39;s~ Norway   Men            2.00 silv~ &quot;Thoralf Str\u0~
##  9  1924 Cross~ Men&#39;s~ Norway   Men            3.00 bron~ &quot;Johan Gr\u00c3~
## 10  1924 Curli~ Men&#39;s~ United ~ Men            1.00 gold  Britain         
## # ... with 2,855 more rows, and 9 more variables: `Age of Athlete` &lt;dbl&gt;,
## #   `alpha-2` &lt;chr&gt;, `alpha-3` &lt;chr&gt;, `country-code` &lt;chr&gt;,
## #   `iso_3166-2` &lt;chr&gt;, region &lt;chr&gt;, `sub-region` &lt;chr&gt;,
## #   `region-code` &lt;chr&gt;, `sub-region-code` &lt;chr&gt;
</pre></div>


<p>Aggregating per country to find the total number of medals for each country and its corresponding alpha-3 code.</p>
<div class="highlight"><pre><span></span>TotalMedalsPerCountry <span class="o">=</span> olympics <span class="o">%&gt;%</span> 
  group_by<span class="p">(</span>Country<span class="p">,</span> <span class="sb">`alpha-3`</span><span class="p">)</span> <span class="o">%&gt;%</span> 
  summarise<span class="p">(</span>TotalMedals <span class="o">=</span> n<span class="p">())</span> <span class="o">%&gt;%</span> 
  rename<span class="p">(</span>Code <span class="o">=</span> <span class="sb">`alpha-3`</span><span class="p">)</span>
TotalMedalsPerCountry
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 39 x 3
## # Groups:   Country [39]
##    Country        Code  TotalMedals
##    &lt;chr&gt;          &lt;chr&gt;       &lt;int&gt;
##  1 Australia      AUS            12
##  2 Austria        AUT           218
##  3 Belarus        BLR            15
##  4 Belgium        BEL             5
##  5 Bulgaria       BGR             6
##  6 Canada         CAN           170
##  7 China          CHN            53
##  8 Croatia        HRV            11
##  9 Czech Republic CZE            49
## 10 Denmark        DNK             1
## # ... with 29 more rows
</pre></div>


<p>Lets see the top countries based on total number of medals</p>
<div class="highlight"><pre><span></span>TotalMedalsPerCountry <span class="o">%&gt;%</span> 
  arrange<span class="p">(</span>desc<span class="p">(</span>TotalMedals<span class="p">))</span>
</pre></div>


<div class="highlight"><pre><span></span>## # A tibble: 39 x 3
## # Groups:   Country [39]
##    Country                  Code  TotalMedals
##    &lt;chr&gt;                    &lt;chr&gt;       &lt;int&gt;
##  1 Germany                  DEU           377
##  2 Russian Federation       RUS           341
##  3 Norway                   NOR           329
##  4 United States of America USA           282
##  5 Austria                  AUT           218
##  6 Canada                   CAN           170
##  7 Finland                  FIN           161
##  8 Sweden                   SWE           144
##  9 Switzerland              CHE           138
## 10 Italy                    ITA           114
## # ... with 29 more rows
</pre></div>


<p>Germany obtained the most number of medals (377) closely followed by Russia with (341)</p>
<h2>Exploring Data</h2>
<p>Lets plot the above data on a choropleth using plotly.</p>
<div class="highlight"><pre><span></span><span class="c1"># light grey boundaries</span>
l <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>color <span class="o">=</span> toRGB<span class="p">(</span><span class="s">&quot;grey&quot;</span><span class="p">),</span> width <span class="o">=</span> <span class="m">0.5</span><span class="p">)</span>

<span class="c1"># specify map projection/options</span>
g <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>
  showframe <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
  showcoastlines <span class="o">=</span> <span class="kc">TRUE</span><span class="p">,</span>
  projection <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>type <span class="o">=</span> <span class="s">&#39;Mercator&#39;</span><span class="p">)</span>
<span class="p">)</span>

p <span class="o">=</span> TotalMedalsPerCountry <span class="o">%&gt;%</span>  
  plot_geo<span class="p">()</span> <span class="o">%&gt;%</span>
  add_trace<span class="p">(</span>
    z <span class="o">=</span> <span class="o">~</span>TotalMedals<span class="p">,</span> color <span class="o">=</span> <span class="o">~</span>TotalMedals<span class="p">,</span> 
    text <span class="o">=</span> <span class="o">~</span>Country<span class="p">,</span> locations <span class="o">=</span> <span class="o">~</span>Code<span class="p">,</span> marker <span class="o">=</span> <span class="kt">list</span><span class="p">(</span>line <span class="o">=</span> l<span class="p">)</span>
  <span class="p">)</span> <span class="o">%&gt;%</span>
  colorbar<span class="p">(</span>title <span class="o">=</span> <span class="s">&#39;Medal Counts&#39;</span><span class="p">)</span> <span class="o">%&gt;%</span>
  layout<span class="p">(</span>
    title <span class="o">=</span> <span class="s">&#39;Number of Medals Per Country In Winter Olympics &lt;br&gt;Source: &lt;a href=&quot;https://data.world/makeovermonday/2018w7-the-winter-olympics&quot;&gt;Data.World Winter Olympics Dataset&lt;/a&gt;&#39;</span><span class="p">,</span>
    geo <span class="o">=</span> g
  <span class="p">)</span>

chart_link <span class="o">=</span> api_create<span class="p">(</span>p<span class="p">,</span> filename <span class="o">=</span> <span class="s">&quot;The Winter Olympics: MakeOverMonday 2018 Week 7&quot;</span><span class="p">,</span> fileopt <span class="o">=</span> <span class="s">&#39;overwrite&#39;</span><span class="p">)</span>
</pre></div>


<div class="highlight"><pre><span></span>## Found a grid already named: &#39;The Winter Olympics: MakeOverMonday 2018 Week 7 Grid&#39;. Since fileopt=&#39;overwrite&#39;, I&#39;ll try to update it
</pre></div>


<div class="highlight"><pre><span></span>## Found a plot already named: &#39;The Winter Olympics: MakeOverMonday 2018 Week 7&#39;. Since fileopt=&#39;overwrite&#39;, I&#39;ll try to update it
</pre></div>


<div class="highlight"><pre><span></span>chart_link
</pre></div>


<iframe src="https://plot.ly/~adityamangal410/70.embed" width="800" height="600" id="igraph" scrolling="no" seamless="seamless" frameBorder="0"> </iframe>

<p>As can be clearly seen above, Norway and USA closely followed in the total medals ranking. 
Visualizing data on choropleth can provide a clear view of the overall data.</p>
<p>I'll try and build more visualizations on this dataset to better understand it in other posts.</p>
  </div>
  <div class="tag-cloud">
    <p>
      <a href="http://adityamangal.com/tag/r.html">R</a>
      <a href="http://adityamangal.com/tag/visualizations.html">Visualizations</a>
      <a href="http://adityamangal.com/tag/makeovermonday.html">MakeOverMonday</a>
      <a href="http://adityamangal.com/tag/dataanalysis.html">DataAnalysis</a>
      <a href="http://adityamangal.com/tag/datascience.html">DataScience</a>
      <a href="http://adityamangal.com/tag/olympics.html">Olympics</a>
    </p>
  </div>

  <div class="center social-share">
    <p>    Like this article? Share it with your friends!
</p>
    <div class="addthis_native_toolbox"></div>
    <div class="addthis_sharing_toolbox"></div>
  </div>



</article>

    <footer>
<p>&copy; Aditya Mangal </p>
<p>    Powered by <a href="http://getpelican.com" target="_blank">Pelican</a> - <a href="https://github.com/alexandrevicenzi/flex" target="_blank">Flex</a> theme by <a href="http://alexandrevicenzi.com" target="_blank">Alexandre Vicenzi</a>
</p>    </footer>
  </main>

<!-- Google Analytics -->
<script type="text/javascript">
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-78062737-2', 'auto');
  ga('send', 'pageview');
</script>
<!-- End Google Analytics -->

    <script type="text/javascript" src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-59cc3b6a1ce7db70" async="async"></script>


<script type="application/ld+json">
{
  "@context" : "http://schema.org",
  "@type" : "Blog",
  "name": " Aditya Mangal's Blog ",
  "url" : "http://adityamangal.com",
  "image": "/images/profile.png",
  "description": "Aditya Mangal's Thoughts and Writings"
}
</script>
</body>
</html>